  jobs:  
  - job: Test
    displayName: Test
    pool:
      vmImage: $(vmImageName)
    steps:
    - task: NodeTool@0
      inputs: 
        versionSpec: '10.x'
      displayName: 'npm install and build'
    - script: |
        npm install
        npm run build
    - task: SnykSecurityScan@0
      displayName: 'Snyk SCA Security Scan'
      inputs:
        serviceConnectionEndpoint: 'Snyk'
        testType: 'app'
        monitorOnBuild: true
        failOnIssues: false
        projectName: 'AZ_Juice'
    - task: SnykSecurityScan@0
      displayName: 'Snyk Container Security Scan'
      inputs:
        serviceConnectionEndpoint: 'Snyk'
        testType: 'container'
        dockerImageName: $(imageName)
        dockerfilePath: '**/Dockerfile'
        monitorOnBuild: true
        failOnIssues: false
